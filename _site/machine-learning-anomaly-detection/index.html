<!DOCTYPE html>
<head>
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="Density estimation, anomaly detection system, and multivariate gaussian distribution.">
<meta name="keywords" content="machine_learning,  machine_learning">
<title>Anomaly Detection  | Machine Learning, Deep Learning, and Computer Vision</title>
<link rel="stylesheet" href="/css/syntax.css">


<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
<!--<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">-->
<link rel="stylesheet" href="/css/modern-business.css">
<link rel="stylesheet" href="/css/lavish-bootstrap.css">
<link rel="stylesheet" href="/css/customstyles.css">
<link rel="stylesheet" href="/css/theme-green.css">

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="/js/jquery.navgoco.min.js"></script>


<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/2.0.0/anchor.min.js"></script>
<script src="/js/toc.js"></script>
<script src="/js/customscripts.js"></script>

<link rel="shortcut icon" href="http://res.cloudinary.com/ritchieng/image/upload/v1468818827/ritchieng.com/favicon_p13h5n.ico">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

<link rel="alternate" type="application/rss+xml" title="" href="http://www.ritchieng.com/feed.xml">




 
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script>
        $(document).ready(function() {
            // Initialize navgoco with default options
            $("#mysidebar").navgoco({
                caretHtml: '',
                accordion: true,
                openClass: 'active', // open
                save: false, // leave false or nav highlighting doesn't work right
                cookie: {
                    name: 'navgoco',
                    expires: false,
                    path: '/'
                },
                slide: {
                    duration: 400,
                    easing: 'swing'
                }
            });

            $("#collapseAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', false);
            });

            $("#expandAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', true);
            });

        });

    </script>
    <script>
        $(function () {
            $('[data-toggle="tooltip"]').tooltip()
        })
    </script>
    
    <!-- Begin Jekyll SEO tag v1.3.1 -->
<title>Anomaly Detection</title>
<meta property="og:title" content="Anomaly Detection" />
<meta name="description" content="I am Ritchie Ng, a machine learning engineer specializing in deep learning and computer vision. Check out my code guides and keep ritching for the skies!" />
<meta property='og:description' content="I am Ritchie Ng, a machine learning engineer specializing in deep learning and computer vision. Check out my code guides and keep ritching for the skies!" />
<link rel="canonical" href="http://www.ritchieng.com/machine-learning-anomaly-detection/" />
<meta property='og:url' content='http://www.ritchieng.com/machine-learning-anomaly-detection/' />
<meta property="article:publisher" content="ritchiengz" />
<meta property="fb:app_id" content="1736736559921494" />
<script type="application/ld+json">
  {
    "@context" : "http://schema.org",


    "@type" : "WebPage",

    "headline": "Anomaly Detection",

    "description": "I am Ritchie Ng, a machine learning engineer specializing in deep learning and computer vision. Check out my code guides and keep ritching for the skies!",

    "logo": "http://www.ritchieng.com/http://res.cloudinary.com/ritchieng/image/upload/v1468818828/ritchieng.com/company_logo_big_ycwbod.png",


    "url" : "http://www.ritchieng.com/machine-learning-anomaly-detection/"
  }
</script>
<!-- End Jekyll SEO tag -->
</head>
<body>
<!-- Navigation -->
<nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="container topnavlinks">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">&nbsp;<span class="projectTitle"> Ritchie Ng</span></a>
        </div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <!-- entries without drop-downs appear here -->
                
                
                
                <li><a href="/programming-languages/">Languages</a></li>
                
                
                
                <li><a href="/machine-learning-resources/">Machine Learning</a></li>
                
                
                
                <li><a href="/news/">Blog</a></li>
                
                
                
                <li><a href="/search/">Search</a></li>
                
                
                
                <!-- entries with drop-downs appear here -->
                <!-- conditional logic to control which topnav appears for the audience defined in the configuration file.-->
                
                

                <!--comment out this block if you want to hide search-->
                <!--<li>-->
                    <!--&lt;!&ndash;start search&ndash;&gt;-->
                    <!--<div id="search-demo-container">-->
                        <!--<input type="text" id="search-input" placeholder="search...">-->
                        <!--<ul id="results-container"></ul>-->
                    <!--</div>-->
                    <!--<script src="/js/jekyll-search.js" type="text/javascript"></script>-->
                    <!--<script type="text/javascript">-->
                            <!--SimpleJekyllSearch.init({-->
                                <!--searchInput: document.getElementById('search-input'),-->
                                <!--resultsContainer: document.getElementById('results-container'),-->
                                <!--dataSource: '/search.json',-->
                                <!--searchResultTemplate: '<li><a href="{url}" title="Anomaly Detection">{title}</a></li>',-->
                    <!--noResultsText: 'No results found.',-->
                            <!--limit: 10,-->
                            <!--fuzzy: true,-->
                    <!--})-->
                    <!--</script>-->
                    <!--end search-->
                </li>
            </ul>
        </div>
        </div>
        <!-- /.container -->
</nav>
<!-- Page Content -->
<div class="container">
    <div class="col-lg-12">&nbsp;</div>
    <!-- Content Row -->
    <div class="row">
        <!-- Sidebar Column -->
        <div class="col-md-3">

          












<ul id="mysidebar" class="nav">
    <li class="sidebarTitle">Machine Learning </li>
    
    
    
    <li>
        <a href="#">Machine Learning Resources</a>
        <ul>
            
            
            
            <li><a href="/machine-learning-resources/">Online Resources</a></li>
            
            
            
            
            
            
            <li><a href="/machine-learning/journals-library/">Journal Library</a></li>
            
            
            
            
            
            
            <li><a href="/machine-learning/datasets">Datasets for Machine Learning</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">Machine Learning and Econometrics</a>
        <ul>
            
            
            
            <li><a href="/machine-learning/econometrics/resources">Resources</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">Supervised Learning Theory</a>
        <ul>
            
            
            
            <li><a href="/machine-learning/">Overview</a></li>
            
            
            
            
            
            
            <li><a href="/one-variable-linear-regression/">One Variable Linear Regression</a></li>
            
            
            
            
            
            
            <li><a href="/linear-algebra-machine-learning/">Linear Algebra</a></li>
            
            
            
            
            
            
            <li><a href="/multi-variable-linear-regression/">Multiple Variable Linear Regression</a></li>
            
            
            
            
            
            
            <li><a href="/logistic-regression/">Logistic Regression</a></li>
            
            
            
            
            
            
            <li><a href="/neural-networks-representation/">Neural Networks (Representation)</a></li>
            
            
            
            
            
            
            <li><a href="/neural-networks-learning/">Neural Networks (Learning)</a></li>
            
            
            
            
            
            
            <li><a href="/applying-machine-learning/">Applying Machine Learning</a></li>
            
            
            
            
            
            
            <li><a href="/machine-learning-systems-design/">Machine Learning Systems Design</a></li>
            
            
            
            
            
            
            <li><a href="/machine-learning-svms-support-vector-machines/">Support Vector Machines</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">Unsupervised Learning Theory</a>
        <ul>
            
            
            
            <li><a href="/machine-learning-unsupervised-learning/">Unsupervised Learning</a></li>
            
            
            
            
            
            
            <li><a href="/machine-learning-dimensionality-reduction/">Dimensionality Reduction</a></li>
            
            
            
            
            
            
            <li class="active"><a href="/machine-learning-anomaly-detection/">Anomaly Detection</a></li>
            
            
            
            
            
            
            <li><a href="/machine-learning-recommender-systems/">Recommender Systems</a></li>
            
            
            
            
            
            
            <li><a href="/machine-learning-large-scale/">Large Scale Machine Learning</a></li>
            
            
            
            
            
            
            <li><a href="/machine-learning-photo-ocr/">Photo OCR</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">Reinforcement Learning Theory</a>
        <ul>
            
            
            
            <li><a href="/machine-learning-markov-decision-processes/">Markov Decision Processes</a></li>
            
            
            
            
            
            
            <li><a href="/machine-learning-reinforcement-learning/">Reinforcement Learning</a></li>
            
            
            
            
            
            
            <li><a href="/machine-learning-game-theory/">Game Theory</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">Deep Learning Theory</a>
        <ul>
            
            
            
            <li><a href="/machine-learning/deep-learning/terms/">Deep Learning Terms</a></li>
            
            
            
            
            
            
            <li><a href="/machine-learning/deep-learning/intro/">Deep Learning Intro</a></li>
            
            
            
            
            
            
            <li><a href="/machine-learning/deep-learning/neural-nets/">Deep Neural Networks Intro</a></li>
            
            
            
            
            
            
            <li><a href="/machine-learning/deep-learning/convs/">Deep Convolutional Networks Intro</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">Deep Learning with TensorFlow</a>
        <ul>
            
            
            
            <li><a href="/machine-learning/deep-learning/tensorflow/notmnist/">Exploring NotMNIST</a></li>
            
            
            
            
            
            
            <li><a href="/machine-learning/deep-learning/tensorflow/deep-neural-nets/">Deep Neural Networks</a></li>
            
            
            
            
            
            
            <li><a href="/machine-learning/deep-learning/tensorflow/regularization/">Regularization</a></li>
            
            
            
            
            
            
            <li><a href="/machine-learning/deep-learning/tensorflow/convnets/">Deep Convolutional Networks</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">Machine Learning with Scikit-Learn</a>
        <ul>
            
            
            
            <li><a href="/machine-learning-intro-easy/">Introduction to Machine Learning</a></li>
            
            
            
            
            
            
            <li><a href="/ipython-introduction/">IPython Introduction</a></li>
            
            
            
            
            
            
            <li><a href="/machine-learning-iris-dataset/">Iris Dataset</a></li>
            
            
            
            
            
            
            <li><a href="/machine-learning-linear-regression/">Linear Regression Model</a></li>
            
            
            
            
            
            
            <li><a href="/machine-learning-evaluate-linear-regression-model/">Linear Regression Model Evaluation</a></li>
            
            
            
            
            
            
            <li><a href="/machine-learning-polynomial-regression/">Polynomial Regression</a></li>
            
            
            
            
            
            
            <li><a href="/machine-learning-multinomial-naive-bayes-vectorization/">Vectorization, Multinomial Naive Bayes Classifier and Evaluation</a></li>
            
            
            
            
            
            
            <li><a href="/machine-learning-gaussian-naive-bayes/">Gaussian Naive Bayes</a></li>
            
            
            
            
            
            
            <li><a href="/machine-learning-k-nearest-neighbors-knn/">K-nearest Neighbors (KNN) Classification Model</a></li>
            
            
            
            
            
            
            <li><a href="/machine-learning-ensemble-of-learners-adaboost/">Ensemble Learning and Adaboost</a></li>
            
            
            
            
            
            
            <li><a href="/machine-learning-decision-trees/">Decision Trees</a></li>
            
            
            
            
            
            
            <li><a href="/machine-learning-svms/">Support Vector Machines</a></li>
            
            
            
            
            
            
            <li><a href="/machine-learning-clustering-kmeans/">Clustering with KMeans</a></li>
            
            
            
            
            
            
            <li><a href="/machine-learning-dimensionality-reduction-feature-transform/">Dimensionality Reduction and Feature Transformation</a></li>
            
            
            
            
            
            
            <li><a href="/machine-learning-feature_engineering_scaling/">Feature Engineering and Scaling</a></li>
            
            
            
            
            
            
            <li><a href="/machine-learning-cross-validation/">Cross-Validation for Parameter Tuning, Model Selection, and Feature Selection</a></li>
            
            
            
            
            
            
            <li><a href="/machine-learning-efficiently-search-tuning-param/">Efficiently Searching Optimal Tuning Parameters</a></li>
            
            
            
            
            
            
            <li><a href="/machine-learning-evaluate-classification-model/">Evaluating a Classification Model</a></li>
            
            
            
            
            
            
            <li><a href="/machinelearning-one-hot-encoding/">One Hot Encoding</a></li>
            
            
            
            
            
            
            <li><a href="/machinelearning-f1-score/">F1 Score</a></li>
            
            
            
            
            
            
            <li><a href="/machinelearning-learning-curve/">Learning Curve</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">Machine Learning Projects</a>
        <ul>
            
            
            
            <li><a href="/machine-learning-project-titanic-survival/">Titanic Survival Data Exploration</a></li>
            
            
            
            
            
            
            <li><a href="/machine-learning-project-boston-home-prices/">Boston House Prices Prediction and Evaluation (Model Evaluation and Prediction)</a></li>
            
            
            
            
            
            
            <li><a href="/machine-learning-project-student-intervention/">Building a Student Intervention System (Supervised Learning)</a></li>
            
            
            
            
            
            
            <li><a href="/machine-learning-project-customer-segments/">Identifying Customer Segments (Unsupervised Learning)</a></li>
            
            
            
            
            
            
            <li><a href="/machine-learning-proj-smart-cab/">Training a Smart Cab (Reinforcement Learning)</a></li>
            
            
            
            
        </ul>
        
        
        
        <!-- if you aren't using the accordion, uncomment this block:
           <p class="external">
               <a href="#" id="collapseAll">Collapse All</a> | <a href="#" id="expandAll">Expand All</a>
           </p>
           -->
    </li>
</ul>
</div>

<!-- this highlights the active parent class in the navgoco sidebar. this is critical so that the parent expands when you're viewing a page. This must appear below the sidebar code above. Otherwise, if placed inside customscripts.js, the script runs before the sidebar code runs and the class never gets inserted.-->
<script>$("li.active").parents('li').toggleClass("active");</script>
    <!-- Content Column -->
    <div class="col-md-9">
        <div class="post-header">
   <h1 class="post-title-main">Anomaly Detection</h1>
</div>



<div class="post-content">

   
    <div class="summary">Density estimation, anomaly detection system, and multivariate gaussian distribution.</div>
   

    
    
<!-- this handles the automatic toc. use ## for subheads to auto-generate the on-page minitoc. if you use html tags, you must supply an ID for the heading element in order for it to appear in the minitoc. -->
<script>
$( document ).ready(function() {
  // Handler for .ready() called.

$('#toc').toc({ minimumHeaders: 0, listType: 'ul', showSpeed: 0, headers: 'h2,h3,h4' });

/* this offset helps account for the space taken up by the floating toolbar. */
$('#toc').on('click', 'a', function() {
  var target = $(this.getAttribute('href'))
    , scroll_target = target.offset().top

  $(window).scrollTop(scroll_target - 10);
  return false
})
  
});
</script>

<div id="toc"></div>

    

    

    

    

  <h2 id="density-estimation">1. Density Estimation</h2>
<p>I would like to give full credits to the respective authors as these are my personal python notebooks taken from deep learning courses from Andrew Ng, Data School and Udemy :) This is a simple python notebook hosted generously through Github Pages that is on my main personal notes repository on https://github.com/ritchieng/ritchieng.github.io. They are meant for my personal review but I have open-source my repository of personal notes as a lot of people found it useful.</p>

<h3 id="a-problem-motivation">1a. Problem Motivation</h3>
<ul>
  <li>Anomaly detection example in aircraft engines
<img src="https://raw.githubusercontent.com/ritchieng/machine-learning-stanford/master/w9_anomaly_recommender/anomaly_detection.png" alt="" />
    <ul>
      <li>Density estimation
  <img src="https://raw.githubusercontent.com/ritchieng/machine-learning-stanford/master/w9_anomaly_recommender/anomaly_detection2.png" alt="" /></li>
    </ul>
  </li>
  <li>Other anomaly detection examples
    <ul>
      <li>If you have too many false positives
        <ul>
          <li>Detecting positives when they are not</li>
          <li>Decrease ε
  <img src="https://raw.githubusercontent.com/ritchieng/machine-learning-stanford/master/w9_anomaly_recommender/anomaly_detection3.png" alt="" /></li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<h3 id="b-gaussian-normal-distribution">1b. Gaussian (Normal) Distribution</h3>
<ul>
  <li>This is also called Normal Distribution
    <ul>
      <li>We will be using the Gaussian Distribution to develop an anomaly detection algorithm</li>
    </ul>
  </li>
  <li>Introduction
<img src="https://raw.githubusercontent.com/ritchieng/machine-learning-stanford/master/w9_anomaly_recommender/anomaly_detection4.png" alt="" /></li>
  <li>Gaussian distribution example
    <ul>
      <li>Area under the graph (red shaded area) must always equate to 1
<img src="https://raw.githubusercontent.com/ritchieng/machine-learning-stanford/master/w9_anomaly_recommender/anomaly_detection5.png" alt="" /></li>
    </ul>
  </li>
  <li>Parameter estimation
    <ul>
      <li>m might be (m - 1)
        <ul>
          <li>In practice, it makes very little difference</li>
          <li>In machine learning, most people typically use (1 / m)
<img src="https://raw.githubusercontent.com/ritchieng/machine-learning-stanford/master/w9_anomaly_recommender/anomaly_detection6.png" alt="" /></li>
        </ul>
      </li>
    </ul>
  </li>
  <li>Now we will use the Gaussian distribution to develop an anomaly detection algorithm</li>
</ul>

<h3 id="c-algorithm">1c. Algorithm</h3>
<ul>
  <li>Density estimation
<img src="https://raw.githubusercontent.com/ritchieng/machine-learning-stanford/master/w9_anomaly_recommender/anomaly_detection7.png" alt="" /></li>
  <li>Anomaly detection algorithm
<img src="https://raw.githubusercontent.com/ritchieng/machine-learning-stanford/master/w9_anomaly_recommender/anomaly_detection8.png" alt="" /></li>
  <li>Anomaly detection example
    <ul>
      <li>Height of contour graph = p(x)</li>
      <li>Set some value of ε</li>
      <li>The pink shaded area on the contour graph have a low probability hence they’re anomalous
  <img src="https://raw.githubusercontent.com/ritchieng/machine-learning-stanford/master/w9_anomaly_recommender/anomaly_detection9.png" alt="" /></li>
    </ul>
  </li>
</ul>

<h2 id="building-an-anomaly-detection-system">2. Building an Anomaly Detection System</h2>

<h3 id="a-developing-and-evaluating-an-anomaly-detection-system">2a. Developing and Evaluating an Anomaly Detection System</h3>
<ul>
  <li>Importance of real-number evaluation
    <ul>
      <li>When developing a learning algorithm (choosing features etc.), making decisions is much easier if we have a way of evaluating our learning algorithm</li>
      <li>Assume we have some labeled data, of anomalous and non-anomalous examples
        <ul>
          <li>y = 0 if normal</li>
          <li>y = 1 if anomalous</li>
        </ul>
      </li>
      <li>Training set (x1, x2, …, xm)
        <ul>
          <li>Assume normal examples, not anomalous</li>
        </ul>
      </li>
      <li>Cross validation set (xcv_1, xcv_2, …, xcv_m)</li>
      <li>Test set (xtest_1, …, xtest_m)</li>
    </ul>
  </li>
  <li>Aircraft engines example
    <ul>
      <li>10,000 good (normal) engines</li>
      <li>20 flawed (anomalous) engines
        <ul>
          <li>Training set: 6000 good engines
            <ul>
              <li>This will be used to fit p(x)</li>
            </ul>
          </li>
          <li>CV: 2000 good engines (y = 0), 10 anomalous (y = 1)</li>
          <li>Test: 2000 good engines (y = 0), 10 anomalous (y = 1)</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>Algorithm Evaluation
    <ul>
      <li>Because y = 0 is more common, there is a skewed data set
        <ul>
          <li>Hence, classification metric is not appropriate
  <img src="https://raw.githubusercontent.com/ritchieng/machine-learning-stanford/master/w9_anomaly_recommender/anomaly_detection10.png" alt="" /></li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<h3 id="b-anomaly-detection-vs-supervised-learning">2b. Anomaly Detection vs Supervised Learning</h3>
<p>| Anomaly Detection   |      Supervised Learning      |
|———-|————-|
| Very small number of positive examples (y = 1 such that 0-20)  |  Large number of positive and negative examples |
| Large number of negative examples (y = 0) |       |
| Many different types of anomalies. Hard for any algorithm to learn from positive examples what the anomalies look like; future anomalies may look nothing like any of the anomalous examples we have seen so far. | Enough positive examples for algorithm to get a sense of what positive examples are like, future positive examples likely to be similar to ones in training set. |
| Fraud Detection | Email Spam Classification |
| Manufacturing | Weather Prediction |
| Monitoring machines in a data center | Cancer Classification |</p>

<h3 id="c-choosing-what-features-to-use">2c. Choosing What Features to Use</h3>
<ul>
  <li>Non-gaussian features
    <ul>
      <li>If the data is non-gaussian, you can transform the data to make it resemble a gaussian distribution
  <img src="https://raw.githubusercontent.com/ritchieng/machine-learning-stanford/master/w9_anomaly_recommender/anomaly_detection11.png" alt="" /></li>
    </ul>
  </li>
  <li>How do we come up with  features?
    <ul>
      <li>Error analysis for anomaly detection
        <ul>
          <li>This allows us to come up with features</li>
          <li>This is similar to the error analysis procedure that we have for supervised learning, where we would train a complete algorithm, and run the algorithm on a cross validation set, and look at the examples it gets wrong, and see if we can come up with extra features to help the algorithm do better on the examples that it got wrong in the cross-validation set
  <img src="https://raw.githubusercontent.com/ritchieng/machine-learning-stanford/master/w9_anomaly_recommender/anomaly_detection12.png" alt="" /></li>
        </ul>
      </li>
    </ul>
  </li>
  <li>How do we choose features?
    <ul>
      <li>Choose features that might take on unusually large or small values in the event of an anomaly</li>
      <li>Example: monitoring computers in a data center
        <ul>
          <li>The new feature x5 would take a very large value when there is a huge CPU load but low network traffic</li>
          <li>This way you can catch anomalies
  <img src="https://raw.githubusercontent.com/ritchieng/machine-learning-stanford/master/w9_anomaly_recommender/anomaly_detection13.png" alt="" /></li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<h2 id="multivariate-gaussian-distribution">3. Multivariate Gaussian Distribution</h2>

<h3 id="a-introduction">3a. Introduction</h3>
<ul>
  <li>Monitoring machines in a data center example
    <ul>
      <li>The green cross has a pretty high probability</li>
      <li>The anomaly detection algorithm may not detect this anomaly</li>
      <li>We have to use a multivariate gaussian (normal) distribution to fix this issue
  <img src="https://raw.githubusercontent.com/ritchieng/machine-learning-stanford/master/w9_anomaly_recommender/anomaly_detection14.png" alt="" /></li>
    </ul>
  </li>
  <li>Multivariate Gaussian (Normal) Distribution
    <ul>
      <li>Covariance matrix, Σ
        <ul>
          <li>Varying two elements (diagonal) - variance
            <ul>
              <li>If you reduce sigma, sharper gaussian</li>
              <li>If you increase sigma, wider gaussian
  <img src="https://raw.githubusercontent.com/ritchieng/machine-learning-stanford/master/w9_anomaly_recommender/anomaly_detection15.png" alt="" /></li>
            </ul>
          </li>
          <li>Varying one element (diagonal) - variance
            <ul>
              <li>Reduce variance of x1 and keep variance of x2 constant (middle graph)</li>
              <li>Increase variance of x1 and keep variance of x2 constant (right graph)
  <img src="https://raw.githubusercontent.com/ritchieng/machine-learning-stanford/master/w9_anomaly_recommender/anomaly_detection16.png" alt="" /></li>
            </ul>
          </li>
          <li>Varying two elements (opt diagonal) - correlation
  <img src="https://raw.githubusercontent.com/ritchieng/machine-learning-stanford/master/w9_anomaly_recommender/anomaly_detection17.png" alt="" />
  <img src="https://raw.githubusercontent.com/ritchieng/machine-learning-stanford/master/w9_anomaly_recommender/anomaly_detection18.png" alt="" /></li>
        </ul>
      </li>
      <li>Mean matrix, μ
        <ul>
          <li>Varying the μ parameter shifts the center of the distribution
  <img src="https://raw.githubusercontent.com/ritchieng/machine-learning-stanford/master/w9_anomaly_recommender/anomaly_detection19.png" alt="" /></li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<h3 id="b-anomaly-detection-using-multivariate-gaussian-distribution">3b. Anomaly Detection using Multivariate Gaussian Distribution</h3>
<ul>
  <li>Multivariate gaussian distribution
<img src="https://raw.githubusercontent.com/ritchieng/machine-learning-stanford/master/w9_anomaly_recommender/anomaly_detection20.png" alt="" /></li>
  <li>Anomaly detection algorithm using multivariate gaussian distribution
    <ul>
      <li>It will flag the green arrow as an anomaly
<img src="https://raw.githubusercontent.com/ritchieng/machine-learning-stanford/master/w9_anomaly_recommender/anomaly_detection21.png" alt="" /></li>
    </ul>
  </li>
  <li>Relationship with original model
    <ul>
      <li>The original model is actually a special case of the multivariate gaussian model
  <img src="https://raw.githubusercontent.com/ritchieng/machine-learning-stanford/master/w9_anomaly_recommender/anomaly_detection22.png" alt="" /></li>
      <li>Try to get rid features that are linearly dependent and duplicate features for multivariate gaussian model
  <img src="https://raw.githubusercontent.com/ritchieng/machine-learning-stanford/master/w9_anomaly_recommender/anomaly_detection23.png" alt="" /></li>
    </ul>
  </li>
</ul>



<div class="tags">
    
    <b>Tags: </b>
    
    
    
    <a href="/tag_machine_learning" class="btn btn-default navbar-btn cursorNorm" role="button">machine_learning</a>
    
    
    
</div>
    <!--<div>

    <a href="http://facebook.com/sharer.php?u=http://www.ritchieng.com/machine-learning-anomaly-detection/" rel="nofollow" target="_blank" title="Share on Facebook" style="color:#fff; background:#3b5998; padding: 6px; text-decoration: none;">Facebook</a>

    <a href="http://twitter.com/intent/tweet?text=Anomaly Detection&url=http://www.ritchieng.com/machine-learning-anomaly-detection/&via=&related=" rel="nofollow" target="_blank" title="Share on Twitter" style="color:#fff; background:#00aced; padding: 6px; text-decoration: none;">Twitter</a>

    <a href="http://plus.google.com/share?url=http://www.ritchieng.com/machine-learning-anomaly-detection/" rel="nofollow" target="_blank" title="Share on Google+" style="color:#fff; background:#dd4b39; padding: 6px; text-decoration: none;">Google+</a>

</div>-->
    <br />
<br />
<div id="disqus_thread"></div>
<script>
    /**
     *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
     *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
     */
    /*
     var disqus_config = function () {
     this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
     this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
     };
     */
    (function() {  // DON'T EDIT BELOW THIS LINE
        var d = document, s = d.createElement('script');

        s.src = '//ritchieng.disqus.com/embed.js';

        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>


</div>

<hr class="shaded"/>

<footer>
            <div class="row">
                <div class="col-lg-12 footer">
               &copy; 2019 Ritchie Ng. All rights reserved. <br />
 Site last updated: Mar 18, 2019 <br />
                    <a href="https://github.com/ritchieng">Github</a> | <a href="https://www.linkedin.com/in/ritchieng">Linkedin</a> | <a href="https://www.facebook.com/ritchiengz">Facebook</a> | <a href="https://twitter.com/ritchieng">Twitter</a> | <a href="https://www.techinasia.com/profile/ritchieng">Tech in Asia</a>
<!--<p><img src="http://res.cloudinary.com/ritchieng/image/upload/v1468818828/ritchieng.com/company_logo_p3uvgl.png" alt="Ritchie Ng"/></p>-->
                </div>
            </div>
</footer>

    </div>
    <!-- /.row -->
</div>
<!-- /.container -->
    </div>
    <script>
    jQuery(function ($) {
        $('.post-content').annotator()
                .annotator('setupPlugins', {tokenUrl: 'http://example.com/api/token'})
    });
    </script>
</body>
<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-79887611-1', 'auto');
    ga('send', 'pageview');

</script>
</html>